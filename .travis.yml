---
sudo: required
dist: trusty

language: python
python: "2.7"

services:
- docker

before_install:
- sudo apt-get update -qq
- sudo apt-get install -qq python-apt python3-apt python-pip python3-pip sssd apt-get linux-image-extra-$(uname -r) linux-image-extra-virtual apt-transport-https ca-certificates curl software-properties-common
- curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
- sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"
- sudo apt-get update -qq
- sudo apt-get install -qq docker-ce

install:
- pip install ansible docker-py

script:
- ansible-playbook setup.yml --extra-vars "builddir=${TRAVIS_BUILD_DIR}/"
- /test/test-all.sh
